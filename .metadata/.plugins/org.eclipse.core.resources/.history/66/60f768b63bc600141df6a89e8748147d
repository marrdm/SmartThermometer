/*
 * pwm.c
 *
 *  Created on: 5 Mar 2015
 *      Author: Marcus
 */

#include "pwm.h"

void pwm_init(){
	LPC_SYSCON->SYSAHBCLKCTRL |= (1<<10);		//Power up tmr0
	LPC_IOCON->R_PIO1_1 = 3;

	LPC_TMR32B1->PR = 28;
	LPC_TMR32B1->MCR |= (1<<10);
	LPC_TMR32B1->MR3 = 255;
	LPC_TMR32B1->MR0 = 0;

	LPC_TMR32B1->PWMC = (1<<0);
	LPC_TMR32B1->PWMC |= (1<<3);

	LPC_TMR32B1->TCR = 0x2;		//Reset timer
	LPC_TMR32B1->TCR = 0x1;		//Start timer
}

void pwm_red(int value){
	if(value < 0){
		value = 0;
	}else if(value > 255){
		value = 255;
	}
	LPC_TMR32B1->MR0 = value;
}

